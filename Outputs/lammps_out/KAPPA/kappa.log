LAMMPS (30 Apr 2019)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:88)
  using 1 OpenMP thread(s) per MPI task
# Sample LAMMPS input script for thermal conductivity of solid Al (Hopefully)

units       real
variable T file temp.txt
variable    V equal vol
variable    dt equal 4.0
variable    p equal 2000     # correlation length
variable    s equal 1      # sample interval
variable    d equal $p*$s   # dump interval
variable    d equal 2000*$s   
variable    d equal 2000*1   

# convert from LAMMPS real units to SI

variable    kB equal 1.3806504e-23    # [J/K] Boltzmann
variable    kCal2J equal 4186.0/6.02214e23
variable    A2m equal 1.0e-10
variable    fs2s equal 1.0e-15
variable    convert equal ${kCal2J}*${kCal2J}/${fs2s}/${A2m}
variable    convert equal 6.95101741241486e-21*${kCal2J}/${fs2s}/${A2m}
variable    convert equal 6.95101741241486e-21*6.95101741241486e-21/${fs2s}/${A2m}
variable    convert equal 6.95101741241486e-21*6.95101741241486e-21/1e-15/${A2m}
variable    convert equal 6.95101741241486e-21*6.95101741241486e-21/1e-15/1e-10

# setup problem

dimension    3
boundary     p p p
variable rho file lat_const.txt
lattice      fcc ${rho} orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
lattice      fcc 3.64754889370016 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
Lattice spacing in x,y,z = 3.64755 3.64755 3.64755
region       box block 0 4 0 4 0 4
create_box   1 box
Created orthogonal box = (0 0 0) to (14.5902 14.5902 14.5902)
  1 by 1 by 1 MPI processor grid
create_atoms 1 box
Created 256 atoms
  create_atoms CPU = 0.000217467 secs
mass         1 26.981539
pair_style	eam/fs
pair_coeff * * ./Al1.eam.fs Al
timestep     ${dt}
timestep     4
thermo       $d
thermo       2000

# equilibration and thermalization

velocity     all create $T 102486 mom yes rot yes dist gaussian
velocity     all create 301.0 102486 mom yes rot yes dist gaussian
fix          NVT all nvt temp $T $T 10 drag 0.2
fix          NVT all nvt temp 301.0 $T 10 drag 0.2
fix          NVT all nvt temp 301.0 301.0 10 drag 0.2
run          8000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 8.5
  ghost atom cutoff = 8.5
  binsize = 4.25, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/fs, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.411 | 3.411 | 3.411 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0          301   -713.52989            0   -484.73781    75896.202 
    2000    319.17137   -494.17538            0   -251.57112    162429.91 
    4000    299.67089   -516.21563            0   -288.43382    154843.99 
    6000    310.62618   -490.73315            0   -254.62415    162583.22 
    8000    298.81504   -495.88234            0   -268.75106    157392.16 
Loop time of 6.35263 on 1 procs for 8000 steps with 256 atoms

Performance: 435.221 ns/day, 0.055 hours/ns, 1259.321 timesteps/s
99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.0364     | 6.0364     | 6.0364     |   0.0 | 95.02
Neigh   | 0.1974     | 0.1974     | 0.1974     |   0.0 |  3.11
Comm    | 0.0705     | 0.0705     | 0.0705     |   0.0 |  1.11
Output  | 7.1116e-05 | 7.1116e-05 | 7.1116e-05 |   0.0 |  0.00
Modify  | 0.032275   | 0.032275   | 0.032275   |   0.0 |  0.51
Other   |            | 0.01593    |            |       |  0.25

Nlocal:    256 ave 256 max 256 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    2341 ave 2341 max 2341 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    26965 ave 26965 max 26965 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 26965
Ave neighs/atom = 105.332
Neighbor list builds = 301
Dangerous builds = 0

# thermal conductivity calculation, switch to NVE if desired

#unfix       NVT
#fix         NVE all nve

reset_timestep 0
compute      myKE all ke/atom
compute      myPE all pe/atom
compute      myStress all stress/atom NULL virial
compute      flux all heat/flux myKE myPE myStress
variable     Jx equal c_flux[1]/vol
variable     Jy equal c_flux[2]/vol
variable     Jz equal c_flux[3]/vol
fix          JJ all ave/correlate $s $p $d              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
fix          JJ all ave/correlate 1 $p $d              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
fix          JJ all ave/correlate 1 2000 $d              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
fix          JJ all ave/correlate 1 2000 2000              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
variable     scale equal ${convert}/${kB}/$T/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/${kB}/$T/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/$T/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/3105.87047558285*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/3105.87047558285*1*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/3105.87047558285*1*4
variable     k11 equal trap(f_JJ[3])*${scale}
variable     k11 equal trap(f_JJ[3])*0.49745830939476
variable     k22 equal trap(f_JJ[4])*${scale}
variable     k22 equal trap(f_JJ[4])*0.49745830939476
variable     k33 equal trap(f_JJ[5])*${scale}
variable     k33 equal trap(f_JJ[5])*0.49745830939476
thermo_style custom step temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33
run          100000
Per MPI rank memory allocation (min/avg/max) = 5.287 | 5.287 | 5.287 Mbytes
Step Temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33 
       0    298.81504 0.00017018328 -0.00018957428 7.8027958e-05  0.069490777  0.086228773  0.014608104 
    2000    294.07169 -0.00011557765 0.00024517248 -8.3454245e-05   -4.1235984    -3.158391   -5.8866326 
    4000    301.60159 0.00017532951 0.00010281434 0.00017657346  -0.88164851   -3.5332761  -0.46371529 
    6000    303.72954 -0.00013295807 -9.032242e-05 -7.4674974e-05  -0.18694594   -2.6435508  -0.21743043 
    8000    307.53998 9.0755312e-05 3.7702911e-05 -0.00026736479   0.28345871   -1.3394071  -0.49692895 
   10000    282.51025 -4.4773827e-05 -3.4254822e-05 0.00014100998    1.4173574  -0.74639294  -0.36526473 
   12000    291.19321 3.8421042e-05 -0.00023349783 -0.00015181123    2.1588977  -0.59524359  -0.33977555 
   14000    282.58799 -2.944976e-05 3.2963218e-05 1.9414509e-05    1.5940812  -0.33152094  -0.46262381 
   16000    309.60453 9.8431919e-06 -0.00025454498 -0.00038638756    1.6510033  -0.42488509  -0.50138993 
   18000    323.59001 0.00015328297 -0.00034566929 -1.7718147e-05    1.3148899 -0.028983465  -0.36336077 
   20000    313.69934 9.3475052e-05 7.3821714e-05 -8.9919132e-05   0.85705912   0.20452682   0.13244752 
   22000    287.84456 9.2782795e-06 0.00016743606 0.00019781056     1.031642   0.18493739  -0.25422447 
   24000    306.27432 4.3778989e-05 -0.00019218243 5.126214e-05    0.9239905   0.23393341 -0.030615044 
   26000    306.44434 -0.00028123275 7.4346405e-05 1.3322959e-05    0.8550481   0.45316132   0.32973185 
   28000    320.94896 0.00021016388 0.00048333345 7.2829284e-05   0.76214835   0.52242273   0.42518752 
   30000    293.17919 -0.00020230474 -0.00011394505 -5.1513274e-05   0.72566044   0.43401677   0.48324939 
   32000    287.91397 0.00045259203 0.00030254417 5.7319019e-05   0.84171301   0.53027987   0.50636933 
   34000    301.79667 0.00022289444 0.0001056715 -4.2317525e-05    0.5841951   0.22144507   0.60639655 
   36000    297.86372 0.00015065397 -1.6672715e-05 -0.0001466812    1.0480733   0.45317798   0.51760902 
   38000    309.54838 8.8850634e-05 -0.0002230969 0.00033467359    1.4186443   0.51475572   0.52827793 
   40000    293.20288 -9.5871152e-05 0.00018910739 -4.0933494e-05     1.338374   0.58318588   0.71848845 
   42000    305.58318 5.4630862e-05 -0.00019998322 -0.00024074381    1.3154382   0.73697367   0.71592945 
   44000    292.22296 -0.00020676455 -0.00018114732 -3.6274681e-07     1.397791   0.69433198   0.55553611 
   46000    318.65619 -0.00025114352 0.00011085818 0.00018925255     1.399144   0.65806064   0.66008131 
   48000    295.73305 -0.00015388759 0.00034524858 -1.336424e-05    1.6175541   0.69529589    1.0497353 
   50000    316.20169 0.00048182404 6.9577248e-06 0.00019219027    1.5834215   0.83862622   0.96866708 
   52000    316.12314 8.0389963e-05 6.7268687e-05 -0.00027573657     1.490718   0.79852899   0.99762142 
   54000     285.3031 -0.00010597273 -0.00032561002 0.00025338389    1.4682312    0.7111487   0.94652676 
   56000    305.53749 0.00018475603 6.5884676e-05 0.00013544665    1.4421962   0.98104996    1.0059865 
   58000     314.7504 0.00025815893 -0.0001031018 2.455605e-05    1.5169904    0.9041954   0.97394888 
   60000     309.0951 0.00032802895 -0.00025633524 -0.00019989158    1.6364221   0.91935648    1.1872988 
   62000    300.50267 0.00023939685 -0.00024961544 0.00032159931    1.5450141   0.88412954    1.1236024 
   64000    305.66137 0.0001252361 -0.00030933278 0.00010870575    1.4899469   0.85994832    1.0957077 
   66000    315.87107 0.0003261753 5.5618134e-05 -8.0514058e-06    1.4520009   0.86513604    1.1054295 
   68000    274.78256 -8.9040677e-07 -0.00012575539 -6.480188e-05    1.6405727   0.92709017    1.1862428 
   70000    316.43265 0.00020808946 0.00031993983 0.00025806491     1.560759    0.8572517    1.2359746 
   72000    297.18997 -5.4316667e-05 0.00029131528 4.7845834e-05    1.5346193   0.86199065    1.3037708 
   74000    294.53381 1.6641355e-05 6.1639751e-05 0.00016398797    1.5433813   0.81474122    1.3688388 
   76000    302.22787 -5.9470581e-05 -3.1405911e-05 0.00017892227    1.4908626   0.88340595    1.3045944 
   78000    301.63195 0.0002792735 -0.00028536936 -0.00021925434    1.5137647    1.2791829    1.3425543 
   80000    315.49833 8.7875985e-05 -7.3127836e-05 3.0787885e-05    1.4838595    1.3463553    1.8853577 
   82000    281.21457 1.7522124e-05 -0.00022288885 0.00050169636    1.6150696    1.3155262    1.9062907 
   84000    304.34519 -0.00014922235 0.00024818246 0.00011444022    1.6990818    1.2841603    1.8697564 
   86000    282.29112 -0.00022957815 -0.0001264388 3.3099577e-05    1.6643468    1.2352019    1.8556865 
   88000    281.23198 0.00041578653 0.00030448882 -0.00015525683    1.6085781    1.2802251    1.9409264 
   90000    290.12295 1.189045e-05 0.00041013398 9.0488576e-05    1.5568387    1.3181235    1.8929873 
   92000     319.0559 0.0002644302 -4.9718111e-05 1.2479375e-05    1.5359483    1.2510142    1.8463691 
   94000    317.40671 -0.00024755892 4.2198668e-05 6.7688852e-05    1.5744394    1.2149954    1.9719209 
   96000    291.04809 0.00011123923 1.6317337e-05 -6.5689929e-05    1.5894009    1.1810828    2.0041108 
   98000    312.24523 0.00025807053 5.9960426e-05 0.00011088318    1.8559281    1.1480053    1.9844503 
  100000    305.37839 -0.00011751754 5.053102e-05 -0.00014836178    1.7378528    1.4465285    1.9594874 
Loop time of 111.204 on 1 procs for 100000 steps with 256 atoms

Performance: 310.781 ns/day, 0.077 hours/ns, 899.250 timesteps/s
99.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.62     | 102.62     | 102.62     |   0.0 | 92.29
Neigh   | 2.5208     | 2.5208     | 2.5208     |   0.0 |  2.27
Comm    | 0.90238    | 0.90238    | 0.90238    |   0.0 |  0.81
Output  | 0.004205   | 0.004205   | 0.004205   |   0.0 |  0.00
Modify  | 4.9217     | 4.9217     | 4.9217     |   0.0 |  4.43
Other   |            | 0.2301     |            |       |  0.21

Nlocal:    256 ave 256 max 256 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    2351 ave 2351 max 2351 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    26984 ave 26984 max 26984 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 26984
Ave neighs/atom = 105.406
Neighbor list builds = 3740
Dangerous builds = 0
variable     k equal (v_k11+v_k22+v_k33)/3.0
variable     ndens equal count(all)/vol
print        "average conductivity: $k[W/mK] @ $T K, ${ndens} /A\^3"
average conductivity: 1.71462289991933[W/mK] @ 301.0 K, 0.0824245576280701 /A\^3
print $k file Therm_cond.txt
print 1.71462289991933 file Therm_cond.txt
1.71462289991933
Total wall time: 0:01:57
