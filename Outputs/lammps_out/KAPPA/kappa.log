LAMMPS (30 Apr 2019)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:88)
  using 1 OpenMP thread(s) per MPI task
# Sample LAMMPS input script for thermal conductivity of solid Al (Hopefully)

units       real
variable T file temp.txt
variable    V equal vol
variable    dt equal 4.0
variable    p equal 2000     # correlation length
variable    s equal 1      # sample interval
variable    d equal $p*$s   # dump interval
variable    d equal 2000*$s   
variable    d equal 2000*1   

# convert from LAMMPS real units to SI

variable    kB equal 1.3806504e-23    # [J/K] Boltzmann
variable    kCal2J equal 4186.0/6.02214e23
variable    A2m equal 1.0e-10
variable    fs2s equal 1.0e-15
variable    convert equal ${kCal2J}*${kCal2J}/${fs2s}/${A2m}
variable    convert equal 6.95101741241486e-21*${kCal2J}/${fs2s}/${A2m}
variable    convert equal 6.95101741241486e-21*6.95101741241486e-21/${fs2s}/${A2m}
variable    convert equal 6.95101741241486e-21*6.95101741241486e-21/1e-15/${A2m}
variable    convert equal 6.95101741241486e-21*6.95101741241486e-21/1e-15/1e-10

# setup problem

dimension    3
boundary     p p p
variable rho file lat_const.txt
lattice      fcc ${rho} orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
lattice      fcc 4.07296918446211 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
Lattice spacing in x,y,z = 4.07297 4.07297 4.07297
region       box block 0 4 0 4 0 4
create_box   1 box
Created orthogonal box = (0 0 0) to (16.2919 16.2919 16.2919)
  1 by 1 by 1 MPI processor grid
create_atoms 1 box
Created 256 atoms
  create_atoms CPU = 0.000200447 secs
mass         1 26.981539
pair_style	eam/fs
pair_coeff * * ./Al1.eam.fs Al
timestep     ${dt}
timestep     4
thermo       $d
thermo       2000

# equilibration and thermalization

velocity     all create $T 102486 mom yes rot yes dist gaussian
velocity     all create 301.0 102486 mom yes rot yes dist gaussian
fix          NVT all nvt temp $T $T 10 drag 0.2
fix          NVT all nvt temp 301.0 $T 10 drag 0.2
fix          NVT all nvt temp 301.0 301.0 10 drag 0.2
run          8000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 8.5
  ghost atom cutoff = 8.5
  binsize = 4.25, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/fs, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.411 | 3.411 | 3.411 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0          301   -872.71104            0   -643.91896    1781.0932 
    2000    289.12306   -676.32375            0   -456.55942    10392.836 
    4000     311.4003   -673.56064            0   -436.86323    10711.105 
    6000    298.73075   -682.38876            0   -455.32156    10089.831 
    8000    273.66612   -691.36344            0   -483.34802    9582.0781 
Loop time of 4.72359 on 1 procs for 8000 steps with 256 atoms

Performance: 585.317 ns/day, 0.041 hours/ns, 1693.627 timesteps/s
99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.4186     | 4.4186     | 4.4186     |   0.0 | 93.54
Neigh   | 0.1999     | 0.1999     | 0.1999     |   0.0 |  4.23
Comm    | 0.06076    | 0.06076    | 0.06076    |   0.0 |  1.29
Output  | 6.9548e-05 | 6.9548e-05 | 6.9548e-05 |   0.0 |  0.00
Modify  | 0.030448   | 0.030448   | 0.030448   |   0.0 |  0.64
Other   |            | 0.01379    |            |       |  0.29

Nlocal:    256 ave 256 max 256 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1952 ave 1952 max 1952 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    19367 ave 19367 max 19367 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19367
Ave neighs/atom = 75.6523
Neighbor list builds = 350
Dangerous builds = 0

# thermal conductivity calculation, switch to NVE if desired

#unfix       NVT
#fix         NVE all nve

reset_timestep 0
compute      myKE all ke/atom
compute      myPE all pe/atom
compute      myStress all stress/atom NULL virial
compute      flux all heat/flux myKE myPE myStress
variable     Jx equal c_flux[1]/vol
variable     Jy equal c_flux[2]/vol
variable     Jz equal c_flux[3]/vol
fix          JJ all ave/correlate $s $p $d              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
fix          JJ all ave/correlate 1 $p $d              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
fix          JJ all ave/correlate 1 2000 $d              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
fix          JJ all ave/correlate 1 2000 2000              c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
variable     scale equal ${convert}/${kB}/$T/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/${kB}/$T/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/$T/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/$T/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/$V*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/4324.2754176841*$s*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/4324.2754176841*1*${dt}
variable     scale equal 4.83166430676946e-16/1.3806504e-23/301.0/301.0/4324.2754176841*1*4
variable     k11 equal trap(f_JJ[3])*${scale}
variable     k11 equal trap(f_JJ[3])*0.357294789703752
variable     k22 equal trap(f_JJ[4])*${scale}
variable     k22 equal trap(f_JJ[4])*0.357294789703752
variable     k33 equal trap(f_JJ[5])*${scale}
variable     k33 equal trap(f_JJ[5])*0.357294789703752
thermo_style custom step temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33
run          100000
Per MPI rank memory allocation (min/avg/max) = 5.286 | 5.286 | 5.286 Mbytes
Step Temp v_Jx v_Jy v_Jz v_k11 v_k22 v_k33 
       0    273.66612 1.7069577e-05 6.5471455e-06 2.6591903e-05 0.00097334973 0.00014319484 0.0023622302 
    2000     297.6556 -1.5894047e-05 1.1737384e-05 2.934428e-05  0.038670437    4.9079155 -0.085745532 
    4000    293.82367 -7.6088234e-06 3.1169189e-05 -4.8813898e-05   0.36734758    2.5209587  0.099667121 
    6000    318.47773 -5.3329599e-05 -6.36703e-06 7.769316e-06   0.40155986     1.813456   0.10406939 
    8000    324.01928 -5.6049519e-05 -5.0068581e-05 3.9812835e-05   0.21196941    1.3291084   0.26266364 
   10000    299.23407 -1.5807558e-05 -3.4400167e-05 1.9062126e-06   0.23051995    1.0027845   0.11171679 
   12000    289.89396 3.8529554e-05 2.2326996e-05 -1.3512969e-05     0.201057   0.91558552   0.14922259 
   14000    288.12691 2.763488e-05 -3.6899374e-07 1.0404632e-05   0.17407113   0.72699606   0.14806562 
   16000    315.99783 -3.2635788e-05 1.6458736e-05 -1.0014386e-05   0.17862282   0.65853744   0.16149821 
   18000    276.57666 4.9257278e-06 -1.6770614e-05 -1.7730785e-05   0.31441118   0.54446063   0.22937762 
   20000    279.91167 -3.7158359e-05 1.8497466e-05 8.5529361e-06   0.45837617   0.46321423   0.18889525 
   22000    316.91189 1.1796848e-05 9.020669e-05 4.2218056e-05   0.50804484   0.42479328   0.16991229 
   24000    306.56836 2.078986e-08 4.985651e-05 -7.1990529e-05   0.48790936   0.39005219   0.20970722 
   26000    282.55493 2.1956297e-06 3.5903636e-05 -2.3743483e-06   0.42388374   0.36386404   0.35680825 
   28000    321.06835 7.635918e-06 4.3135436e-05 -6.0954449e-07   0.39233584    0.3349507    0.3871137 
   30000    299.94652 -3.2001561e-06 -1.741953e-05 -3.3589275e-06     0.367829   0.30768632   0.36281943 
   32000    303.81849 4.9428817e-05 7.0576934e-06 2.1787186e-05   0.36031569   0.29171624   0.32563706 
   34000    286.35916 8.4799152e-06 -9.849633e-07 -1.8082571e-05   0.40781007   0.27698821   0.30850235 
   36000    288.01867 -1.2457029e-05 -3.6146927e-05 2.239667e-05   0.38304531   0.28968406   0.35753579 
   38000    307.95137 1.4641737e-05 -2.0780975e-05 -2.5109689e-05   0.37032456   0.25811013   0.39698996 
   40000    294.52272 2.9669523e-05 -4.5554701e-05 1.185592e-05   0.34118751   0.24365459   0.40947952 
   42000    313.31555 1.9041065e-05 3.0530474e-05 5.636308e-05   0.31621882   0.23366368   0.35832355 
   44000     304.9231 3.6129334e-05 -6.9452308e-06 5.2460435e-05   0.30872306    0.2204744   0.34736772 
   46000    276.71025 1.9636642e-05 6.2270727e-05 3.6592969e-05   0.32455006   0.21944684   0.30795351 
   48000    288.30621 2.0690069e-05 -2.2519261e-06 -5.6343726e-05    0.2979306   0.20602363     0.294753 
   50000     299.5541 -2.2405378e-05 3.1434406e-05 4.816689e-06   0.28798348   0.20299569   0.28899834 
   52000    311.81405 -4.3708676e-05 -1.9679623e-05 4.1882399e-05   0.28365722   0.21353137   0.29992745 
   54000    302.23517 -2.5075894e-05 -5.7508489e-06 1.8780568e-05   0.28878873   0.21537869    0.2840476 
   56000    303.08001 -6.4695009e-05 -3.9592614e-05 2.8733674e-05   0.29234032    0.2510337   0.29500963 
   58000    315.04763 2.5771685e-05 1.9366645e-05 -1.8021672e-05    0.2813904   0.22542238   0.27541357 
   60000    285.92873 -2.7075365e-05 -3.4952159e-05 -1.5929773e-05   0.28674532   0.24148705   0.27289821 
   62000    320.00188 2.7791702e-06 -1.1696251e-05 -4.6381939e-05   0.28712526    0.2394578   0.27215715 
   64000    302.23916 1.965477e-05 1.7428263e-05 2.4651627e-05   0.27877547   0.24827046   0.26698799 
   66000     324.4521 8.1159251e-06 1.8650357e-05 3.0288493e-05   0.28769935   0.24610395   0.25741766 
   68000    268.85455 4.2107643e-05 -1.1690271e-07 3.9435931e-06   0.28208992   0.24717621   0.25280315 
   70000    307.01267 5.1442303e-05 8.1854804e-05 -2.0967784e-06   0.27906688   0.24533398   0.24571145 
   72000    306.94342 1.7418928e-05 -3.3605647e-06 4.6671935e-05   0.27890967   0.23768191   0.24243284 
   74000    299.14062 1.1922906e-05 6.8315579e-05 -5.1692839e-06   0.27766137   0.24792393   0.23290077 
   76000    302.12174 2.6173063e-05 2.3441312e-05 -2.3477968e-05   0.30724572   0.24733515   0.22649068 
   78000    296.10151 -2.850296e-05 -9.9325724e-06 3.5816177e-05   0.31323931   0.24192466    0.2203143 
   80000     288.2389 -1.1140477e-06 3.9362864e-05 -4.125355e-05   0.29625158   0.23697438   0.26184845 
   82000    299.46367 -2.4481527e-05 -1.9120008e-05 -1.079139e-05   0.28457842   0.26732682   0.26865316 
   84000    319.08857 5.3591926e-07 5.8538176e-06 6.6416606e-08     0.274224   0.29575529   0.26151135 
   86000    309.41842 4.5038083e-05 3.0642254e-05 3.591283e-05   0.26776757   0.28359323    0.2582105 
   88000    299.65021 -1.0068877e-05 1.2338389e-05 -4.3706471e-06    0.2708823   0.27730753   0.24498984 
   90000    318.33974 9.5572358e-06 6.5760196e-06 -3.2075915e-05   0.26543398   0.28712967   0.24112916 
   92000    305.27184 -5.4358512e-05 8.2156492e-06 -2.4280138e-06    0.2557395   0.27144497   0.25621933 
   94000    317.36473 3.8220785e-06 6.1987134e-07 1.4990079e-05   0.27962077   0.26588658   0.24826146 
   96000    299.02916 -3.8321172e-05 3.3050015e-06 2.1302256e-05   0.26775176   0.26566352   0.24406721 
   98000     277.2013 -1.2855157e-05 -3.7347351e-05 -8.3318878e-06   0.27011552    0.2605869    0.2423463 
  100000    279.50232 7.2494496e-05 1.856235e-05 -2.2455115e-05   0.28199506   0.25266129   0.24651558 
Loop time of 83.6011 on 1 procs for 100000 steps with 256 atoms

Performance: 413.392 ns/day, 0.058 hours/ns, 1196.156 timesteps/s
99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.724     | 75.724     | 75.724     |   0.0 | 90.58
Neigh   | 2.4878     | 2.4878     | 2.4878     |   0.0 |  2.98
Comm    | 0.78064    | 0.78064    | 0.78064    |   0.0 |  0.93
Output  | 0.0038333  | 0.0038333  | 0.0038333  |   0.0 |  0.00
Modify  | 4.4095     | 4.4095     | 4.4095     |   0.0 |  5.27
Other   |            | 0.1951     |            |       |  0.23

Nlocal:    256 ave 256 max 256 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1916 ave 1916 max 1916 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    19401 ave 19401 max 19401 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19401
Ave neighs/atom = 75.7852
Neighbor list builds = 4351
Dangerous builds = 0
variable     k equal (v_k11+v_k22+v_k33)/3.0
variable     ndens equal count(all)/vol
print        "average conductivity: $k[W/mK] @ $T K, ${ndens} /A\^3"
average conductivity: 0.260390640372883[W/mK] @ 301.0 K, 0.059200669539477 /A\^3
print $k file Therm_cond.txt
print 0.260390640372883 file Therm_cond.txt
0.260390640372883
Total wall time: 0:01:28
